# S-U-01-4: Role-Based Dashboard Routing

**Epic:** E-01 (Auth Infrastructure)
**Feature:** F-01
**Sprint:** 3
**Lane:** universal (P0)
**Size:** S

## User Story
As an **authenticated user**, I need to be automatically redirected to my persona-specific dashboard after login so that I see the interface relevant to my role without manual navigation.

## Acceptance Criteria
- [ ] After login, user redirected to role-specific dashboard path
- [ ] SuperAdmin -> /admin/dashboard
- [ ] Institutional Admin -> /institution/dashboard
- [ ] Faculty -> /faculty/dashboard
- [ ] Student -> /student/dashboard
- [ ] Advisor -> /advisor/dashboard
- [ ] Unknown/missing role redirects to /unauthorized page
- [ ] Next.js middleware intercepts and redirects on protected routes
- [ ] Unauthenticated users redirected to /login from any protected route
- [ ] Deep linking preserved: redirect back to intended URL after login

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| View | apps/web | src/middleware.ts (Next.js middleware), src/lib/auth/route-guard.ts, src/app/(auth)/login/page.tsx, src/app/unauthorized/page.tsx |
| Components | packages/ui | src/components/auth/redirect-handler.tsx |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-U-01-1, S-U-01-2
- **Cross-epic:** S-U-02-1 (registration leads to dashboard redirect)

## Notes
- Next.js 15 middleware runs at the edge; use Supabase auth helpers for SSR token verification.
- Route groups: `(auth)` for login/register, `(protected)` for authenticated pages.
- Deep link preservation: store intended path in URL search params during login redirect.
- Named exports only for all components and utilities.
