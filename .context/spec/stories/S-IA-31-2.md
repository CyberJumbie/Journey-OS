# S-IA-31-2: PDF Export

**Epic:** E-31 (LCME Report Export)
**Feature:** F-14
**Sprint:** 39
**Lane:** institutional_admin (P2)
**Size:** M

## User Story
As an **institutional admin**, I need to export a formatted compliance report as PDF so that I can share it with LCME reviewers during site visits and accreditation reviews.

## Acceptance Criteria
- [ ] PDF generation from snapshot data
- [ ] Report structure: cover page, executive summary, standard-by-standard breakdown, evidence appendix
- [ ] Cover page: institution name, report date, overall compliance score
- [ ] Executive summary: compliance overview, key strengths, areas for improvement
- [ ] Per-standard section: standard description, element table with compliance status
- [ ] Evidence appendix: condensed evidence chains per element
- [ ] Color-coded compliance badges in PDF (met=green, partial=yellow, unmet=red)
- [ ] API endpoint: GET /api/compliance/snapshots/:id/export/pdf
- [ ] PDF rendered server-side (Puppeteer or @react-pdf/renderer)
- [ ] File size: < 10MB for typical institution
- [ ] Download as file with name: "LCME_Compliance_Report_{institution}_{date}.pdf"

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/compliance/export.types.ts` |
| Service | apps/server | `src/modules/compliance/services/pdf-export.service.ts` |
| Service | apps/server | `src/modules/compliance/services/pdf-templates/report-template.ts` |
| Controller | apps/server | `src/modules/compliance/controllers/snapshot.controller.ts` (extend) |
| Route | apps/server | `src/modules/compliance/routes/snapshot.routes.ts` (extend) |
| View | apps/web | `src/components/compliance/export-pdf-button.tsx` |
| API Tests | apps/server | `src/modules/compliance/__tests__/pdf-export.service.test.ts` |
| API Tests | apps/server | `src/modules/compliance/__tests__/report-template.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-IA-31-1 (snapshot data for PDF content)
- **Cross-epic:** none

## Notes
- Recommend @react-pdf/renderer for server-side PDF generation (React-based templates).
- Alternative: Puppeteer rendering of HTML template to PDF (heavier but more flexible).
- PDF template follows institutional branding; design tokens for colors and fonts.
- Large reports may take 10-30 seconds to generate; use async job with progress notification.
- Consider caching generated PDFs in Supabase Storage for repeated downloads.
