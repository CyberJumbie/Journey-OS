# S-ST-43-2: Time-on-Task Analytics

**Epic:** E-43 (Student Progress Analytics)
**Feature:** F-20
**Sprint:** 28
**Lane:** student (P4)
**Size:** M

## User Story
As a **medical student**, I need to see how much time I spend studying each concept area so that I can optimize my study schedule and allocate more time to weak areas.

## Acceptance Criteria
- [ ] Stacked bar chart or treemap showing time per USMLE system
- [ ] Time period selector: last 7 days, 30 days, 90 days
- [ ] Total study time displayed prominently
- [ ] Average session duration statistic
- [ ] Sessions per week statistic with target indicator (goal: >=3/week)
- [ ] Drill-down: click system to see time per concept within that system
- [ ] Efficiency metric: mastery gain per hour studied per system
- [ ] API aggregates time from practice_sessions table
- [ ] Loading state with skeleton
- [ ] Empty state when no sessions exist

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/student/analytics.types.ts` (extend) |
| Service | apps/server | `src/modules/student/services/time-on-task.service.ts` |
| Controller | apps/server | `src/modules/student/controllers/student-analytics.controller.ts` (extend) |
| View | apps/web | `src/components/student/time-on-task-chart.tsx` |
| Component | apps/web | `src/components/student/study-stats-card.tsx` |
| Component | apps/web | `src/components/student/system-time-breakdown.tsx` |
| API Tests | apps/server | `src/modules/student/__tests__/time-on-task.service.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-ST-42-4 (session history data model exists)
- **Cross-epic:** none

## Notes
- Time tracking granularity: per-question timestamps stored in practice session records.
- Efficiency metric = (mastery_delta / hours_spent) per system; useful for study planning.
- Engagement target of >=3 sessions/week aligns with E-43 DoD.
