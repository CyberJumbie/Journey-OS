# S-F-26-4: Gap Flagging

**Epic:** E-26 (Blueprint & Assembly Engine)
**Feature:** F-12
**Sprint:** 29
**Lane:** faculty (P3)
**Size:** S

## User Story
As a **faculty member**, I need the system to highlight under-represented categories in my exam so that I can address coverage gaps before finalizing the exam.

## Acceptance Criteria
- [ ] Gap analysis runs on current exam composition vs blueprint targets
- [ ] Flags categories below threshold (configurable, default: 80% of target)
- [ ] Gap severity levels: warning (60-80% of target), critical (< 60% of target)
- [ ] Gap summary panel in exam builder showing all flagged categories
- [ ] Suggested actions: "Add 3 more Cardiovascular items" with one-click auto-fill
- [ ] Auto-fill uses recommendation engine to select best items for gap
- [ ] Gaps update in real-time as items are added/removed
- [ ] API endpoint: GET /api/exams/:id/gaps

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/exam/recommendation.types.ts` (extend gap types) |
| Service | apps/server | `src/modules/exam/services/gap-flagging.service.ts` |
| Controller | apps/server | `src/modules/exam/controllers/exam-builder.controller.ts` (extend) |
| View | apps/web | `src/components/exam/gap-summary-panel.tsx` |
| API Tests | apps/server | `src/modules/exam/__tests__/gap-flagging.service.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-F-26-1 (blueprint), S-F-26-2 (recommendation engine for auto-fill)
- **Cross-epic:** none

## Notes
- Gap flagging is an extension of the recommendation engine; reuses coverage computation logic.
- Auto-fill triggers recommendation engine with gap-specific constraints.
- Real-time gap updates are computed client-side for responsiveness, with server validation on save.
