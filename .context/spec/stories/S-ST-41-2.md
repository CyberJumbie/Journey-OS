# S-ST-41-2: Question View Component

**Epic:** E-41 (Adaptive Practice UI)
**Feature:** F-19
**Sprint:** 32
**Lane:** student (P4)
**Size:** L

## User Story
As a **medical student**, I need a question display with answer selection, timer, and flagging so that I can practice items in an exam-like environment with adaptive difficulty.

## Acceptance Criteria
- [ ] Question stem display with rich text (markdown rendering)
- [ ] Answer options (A-E) with radio button selection
- [ ] Image/media support in question stems and answer options
- [ ] Countdown timer (if timed mode) with visual warning at 25% remaining
- [ ] Auto-submit on timer expiry
- [ ] Flag button to mark question for review
- [ ] Question counter: "Question 5 of 25"
- [ ] Navigation: next question (no going back in adaptive mode)
- [ ] Real-time mastery bar showing current session mastery
- [ ] Submit answer triggers: BKT mastery update, next item selection
- [ ] Keyboard shortcuts: 1-5 for options, Enter to submit, F to flag
- [ ] Loading state between questions (while next item is selected)
- [ ] Responsive: full-width on mobile, centered on desktop
- [ ] Accessibility: screen reader support for question and options

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/practice/question.types.ts` |
| Service | apps/server | `src/modules/practice/services/question-flow.service.ts` |
| Controller | apps/server | `src/modules/practice/controllers/question-flow.controller.ts` |
| Route | apps/server | `src/modules/practice/routes/question-flow.routes.ts` |
| View | apps/web | `src/app/(dashboard)/practice/session/[sessionId]/page.tsx` |
| Component | apps/web | `src/components/practice/question-stem.tsx` |
| Component | apps/web | `src/components/practice/answer-options.tsx` |
| Component | apps/web | `src/components/practice/question-timer.tsx` |
| Component | apps/web | `src/components/practice/session-progress-bar.tsx` |
| Component | apps/web | `src/components/practice/mastery-live-bar.tsx` |
| Template | apps/web | `src/components/templates/practice-session-template.tsx` |
| API Tests | apps/server | `src/modules/practice/__tests__/question-flow.service.test.ts` |
| API Tests | apps/server | `src/modules/practice/__tests__/question-flow.controller.test.ts` |
| E2E | apps/web | `e2e/adaptive-practice.spec.ts` |

## Dependencies
- **Blocks:** S-ST-41-3 (feedback after answer)
- **Blocked by:** S-ST-41-1 (session must be launched)
- **Cross-epic:** Calls Python BKT service (S-ST-40-3) and adaptive selector (S-ST-40-4)

## Notes
- Answer submission flow: client -> Express server -> Python BKT update -> Python item selection -> response with feedback + next item.
- SSE for mastery bar updates if latency is a concern; otherwise REST polling.
- No backward navigation in adaptive mode (each item selected based on current mastery).
- Timer component is a reusable atom; same timer used in actual exam delivery.
