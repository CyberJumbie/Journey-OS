# S-F-12-2: LOD Enrichment

**Epic:** E-12 (AI Concept Extraction)
**Feature:** F-06
**Sprint:** 5
**Lane:** faculty (P3)
**Size:** M

## User Story
As a **Faculty member**, I need extracted SubConcepts enriched with Linked Open Data so that concepts are grounded in standard medical terminology (MeSH, SNOMED CT, UMLS).

## Acceptance Criteria
- [ ] StandardTerm TypeScript types: id, name, source_ontology, external_id, uri, description
- [ ] LODEnrichmentService that queries external terminology APIs (MeSH, UMLS)
- [ ] For each SubConcept, attempt to find matching StandardTerm(s)
- [ ] Create StandardTerm nodes in Neo4j if not already present
- [ ] Create `(SubConcept)-[:MAPPED_TO]->(StandardTerm)` relationship
- [ ] DualWriteService for StandardTerm nodes
- [ ] Graceful degradation: if LOD lookup fails, SubConcept proceeds without enrichment
- [ ] SubConcept status updated to `enriched` after successful LOD lookup
- [ ] 8-10 API tests for LOD lookup, StandardTerm creation, dedup of existing terms, fallback behavior

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/concept/standardterm.types.ts` |
| Model | apps/server | `src/models/standardterm.model.ts` |
| Service | apps/server | `src/services/lod.service.ts` |
| Repository | apps/server | `src/repositories/standardterm.repository.ts` |
| Tests | apps/server | `src/tests/lod.service.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-F-12-1 (SubConcepts must be extracted first)
- **Cross-epic:** none

## Notes
- Neo4j label: `StandardTerm` (PascalCase per convention)
- LOD sources priority: MeSH (NLM API) first, UMLS (UMLS API) as fallback
- StandardTerm dedup: lookup by external_id + source_ontology before creating new node
- Rate limiting for external APIs: MeSH allows 3 req/sec, UMLS requires API key with quota
- Enrichment runs asynchronously after extraction; does not block pipeline completion
- Store external API keys in environment variables: MESH_API_KEY, UMLS_API_KEY
