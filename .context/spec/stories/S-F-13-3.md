# S-F-13-3: Batch Operations

**Epic:** E-13 (Concept Review & Verification)
**Feature:** F-06
**Sprint:** 5
**Lane:** faculty (P3)
**Size:** S

## User Story
As a **Faculty member (Course Director)**, I need to batch approve multiple concepts at once so that reviewing large extraction results is efficient.

## Acceptance Criteria
- [ ] Multi-select checkbox on concept review cards
- [ ] "Select All" / "Deselect All" toggle for current filtered view
- [ ] Batch Approve button: approves all selected concepts in a single operation
- [ ] Batch Reject button: rejects all selected with a shared reason prompt
- [ ] Controller endpoint: POST /courses/:id/concepts/batch-review with array of concept IDs and action
- [ ] Transaction: all-or-nothing batch operation (if one fails, none are committed)
- [ ] Progress indicator for large batches (50+ concepts)
- [ ] 5-8 API tests for batch approve, batch reject, partial failure rollback, empty selection

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Controller | apps/server | `src/controllers/conceptReview.controller.ts` (extend) |
| Service | apps/server | `src/services/conceptReview.service.ts` (extend) |
| View | apps/web | `src/components/organisms/ConceptReviewQueue/ConceptReviewQueue.tsx` (extend with batch controls) |
| View - Batch Bar | apps/web | `src/components/molecules/BatchActionBar.tsx` |
| Tests | apps/server | `src/tests/conceptReview.batch.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-F-13-1 (review queue UI must exist)
- **Cross-epic:** none

## Notes
- Batch operation reuses VerificationService from S-F-13-2 in a loop within a transaction
- Neo4j: use UNWIND for batch relationship type swaps in a single query
- Supabase: batch update using `.in('id', conceptIds)` filter
- BatchActionBar is a Molecule that appears when 1+ concepts are selected (sticky bottom bar)
- Maximum batch size: 200 concepts per request to avoid timeout
- Custom error class: `BatchOperationError` with partial results detail
