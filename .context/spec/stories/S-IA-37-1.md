# S-IA-37-1: KaizenML Lint Rule Engine

**Epic:** E-37 (KaizenML Linting & Golden Dataset)
**Feature:** F-17
**Sprint:** 15
**Lane:** institutional_admin (P2)
**Size:** L

## User Story
As an **Institutional Admin**, I need a lint rule engine with 9 rules running on nightly Inngest schedules so that data quality issues in the knowledge graph and item bank are detected automatically.

## Acceptance Criteria
- [ ] 9 lint rules implemented: orphan concepts, dangling SLO links, embedding drift, stale items, tag inconsistency, duplicate framework mappings, missing provenance, score distribution skew, low-confidence tags
- [ ] Each rule returns `{ ruleId, severity, affectedNodes: [], message, suggestedFix }`
- [ ] Inngest cron function: nightly at 2:00 AM UTC (configurable per institution)
- [ ] Lint run creates a `lint_report` record with all findings
- [ ] Incremental linting: only check nodes modified since last run (delta mode)
- [ ] Full lint option: scan entire knowledge graph (manual trigger)
- [ ] Rule enable/disable per institution
- [ ] Severity levels: `critical`, `warning`, `info`
- [ ] Custom error classes: `LintEngineError`, `LintRuleError`
- [ ] 15-20 API tests: each rule, severity classification, delta mode, full scan, schedule config
- [ ] TypeScript strict, named exports only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/kaizen/lint.types.ts`, `src/kaizen/report.types.ts` |
| Model | apps/server | `src/models/lint-report.model.ts` |
| Repository | apps/server | `src/repositories/lint-report.repository.ts` |
| Rules | apps/server | `src/services/kaizen/rules/orphan-concepts.rule.ts`, `src/services/kaizen/rules/dangling-slo.rule.ts`, `src/services/kaizen/rules/embedding-drift.rule.ts`, `src/services/kaizen/rules/stale-items.rule.ts`, `src/services/kaizen/rules/tag-inconsistency.rule.ts`, `src/services/kaizen/rules/duplicate-mappings.rule.ts`, `src/services/kaizen/rules/missing-provenance.rule.ts`, `src/services/kaizen/rules/score-skew.rule.ts`, `src/services/kaizen/rules/low-confidence-tags.rule.ts` |
| Service | apps/server | `src/services/kaizen/lint-engine.service.ts`, `src/services/kaizen/lint-rule-registry.service.ts` |
| Inngest | apps/server | `src/inngest/functions/kaizen-lint.fn.ts` |
| Errors | apps/server | `src/errors/kaizen.errors.ts` |
| Tests | apps/server | `src/tests/kaizen/lint-engine.test.ts`, `src/tests/kaizen/lint-rules.test.ts` |

## Dependencies
- **Blocks:** S-IA-37-2, S-IA-37-3, S-IA-37-4
- **Blocked by:** S-IA-36-1 (admin dashboard exists)
- **Cross-epic:** S-IA-36-1 (Sprint 15 admin dashboard)

## Notes
- "KaizenML" = continuous improvement for ML-generated content â€” brand name for the linting subsystem
- Orphan concepts: Neo4j nodes with no incoming or outgoing relationships
- Embedding drift: compare current embeddings to stored baseline; flag if cosine distance > threshold
- Delta mode uses Supabase `updated_at` timestamps to filter modified nodes
- Lint report stored in Supabase; affected Neo4j node IDs stored as JSONB array
- Consider parallel rule execution for performance (rules are independent)
