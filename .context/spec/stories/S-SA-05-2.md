# S-SA-05-2: Institution Detail View

**Epic:** E-05 (Institution Monitoring)
**Feature:** F-02
**Sprint:** 9
**Lane:** superadmin (P1)
**Size:** M

## User Story
As a **SuperAdmin**, I need an institution detail view showing usage metrics and user breakdown so that I can assess the health and engagement of each institution on the platform.

## Acceptance Criteria
- [ ] InstitutionDetailPage: header with institution name, status badge, creation date
- [ ] Usage metrics section: total users, active users (last 30 days), total courses, total questions generated, total questions approved
- [ ] User breakdown table: role distribution (admins, course directors, faculty, students) with counts
- [ ] Activity timeline: last 10 significant events for this institution
- [ ] Storage usage: documents uploaded count, total storage consumed
- [ ] Charts: monthly active users trend (line chart), questions generated per month (bar chart)
- [ ] Back navigation to institution list
- [ ] Data fetched from `GET /api/admin/institutions/:id/detail`
- [ ] 8-10 API tests: detail rendering, metrics accuracy, user breakdown, activity timeline, charts data
- [ ] Named exports only, TypeScript strict, design tokens only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/admin/institution-detail.types.ts` |
| Service | apps/server | `src/services/admin/institution-monitoring.service.ts` (update) |
| Controller | apps/server | `src/controllers/admin/institution.controller.ts` (update) |
| Molecules | packages/ui | `src/molecules/metric-card.tsx`, `src/molecules/usage-chart.tsx` |
| Organisms | apps/web | `src/components/admin/institution-detail-header.tsx`, `src/components/admin/institution-metrics-grid.tsx`, `src/components/admin/user-breakdown-table.tsx`, `src/components/admin/institution-activity-timeline.tsx` |
| Pages | apps/web | `src/app/(superadmin)/institutions/[id]/page.tsx` |
| Hooks | apps/web | `src/hooks/use-institution-detail.ts` |
| Tests | apps/server | `src/tests/admin/institution-detail.test.ts` |
| Tests | apps/web | `src/tests/admin/institution-detail-page.test.tsx` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-SA-05-1 (institution list to navigate from)
- **Cross-epic:** none

## Notes
- Route: `/institutions/[id]` â€” dynamic segment for institution UUID
- Monthly trends charts use `recharts` library (lightweight, React-native)
- User breakdown query: `SELECT role, COUNT(*) FROM users WHERE institution_id = $id GROUP BY role`
- Active users: users with at least one `activity_events` entry in last 30 days
- Storage usage: `SELECT COUNT(*), SUM(file_size) FROM uploaded_documents WHERE institution_id = $id`
- Activity timeline reuses `ActivityEventRow` molecule from S-F-32-1 but scoped to institution
