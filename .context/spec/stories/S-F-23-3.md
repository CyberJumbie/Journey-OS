# S-F-23-3: Review Actions

**Epic:** E-23 (Faculty Review UI)
**Feature:** F-10
**Sprint:** 13
**Lane:** faculty (P3)
**Size:** M

## User Story
As a **Faculty member**, I need to approve, reject, or request revision on reviewed questions with comments so that the review workflow produces a clear decision with rationale.

## Acceptance Criteria
- [ ] Three action buttons: Approve, Reject, Request Revision
- [ ] Each action requires a comment (optional for approve, required for reject/revise)
- [ ] Comment thread: threaded discussion on each question for multi-round review
- [ ] Approve: transitions status to `approved`, writes to item bank, triggers dual-write
- [ ] Reject: transitions status to `rejected` with reason, archives question
- [ ] Request Revision: transitions to `revision_requested`, notifies original generator
- [ ] Revision resubmission re-enters validation → critic → router pipeline
- [ ] Audit trail: all actions logged with actor, timestamp, comment, previous status
- [ ] 10-14 API tests: each action, comment threading, status transitions, audit trail, resubmission flow
- [ ] TypeScript strict, named exports only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/review/action.types.ts` |
| Service | apps/server | `src/services/review/review-action.service.ts`, `src/services/review/comment-thread.service.ts` |
| Controller | apps/server | `src/controllers/review/review-action.controller.ts` |
| Repository | apps/server | `src/repositories/review-comment.repository.ts` |
| View | apps/web | `src/components/review/ReviewActionBar.tsx`, `src/components/review/CommentThread.tsx` |
| Tests | apps/server | `src/tests/review/review-action.test.ts`, `src/tests/review/comment-thread.test.ts` |

## Dependencies
- **Blocks:** S-F-25-1
- **Blocked by:** S-F-23-1 (review queue exists)
- **Cross-epic:** S-F-25-1 (Sprint 18 item bank needs approved items)

## Notes
- Approve action triggers DualWriteService: Supabase `questions` table update → Neo4j `Question` node status update
- Comment thread stored in Supabase `review_comments` table with `question_id` FK
- Revision resubmission creates a new version, preserving the original for audit
- Consider optimistic UI update for action buttons with rollback on failure
- Keyboard shortcuts: Ctrl+Enter approve, Ctrl+Shift+R reject, Ctrl+Shift+E request revision
