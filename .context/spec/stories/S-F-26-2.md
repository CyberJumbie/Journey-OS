# S-F-26-2: Item Recommendation Engine

**Epic:** E-26 (Blueprint & Assembly Engine)
**Feature:** F-12
**Sprint:** 29
**Lane:** faculty (P3)
**Size:** L

## User Story
As a **faculty member**, I need the system to recommend items that maximize blueprint coverage so that I can efficiently build exams that meet all distribution targets.

## Acceptance Criteria
- [ ] Algorithm accepts blueprint + item bank and returns ranked item list
- [ ] Coverage-maximizing greedy selection: prioritize items filling largest gaps
- [ ] Multi-dimensional coverage: simultaneously optimize across USMLE system, discipline, and Bloom level
- [ ] Constraint: no duplicate concepts in selected set (configurable)
- [ ] Constraint: respect item difficulty distribution (easy/medium/hard ratio)
- [ ] Output includes coverage score (0-100%) and gap analysis
- [ ] Support for manual overrides: lock specific items, exclude others
- [ ] Performance: recommend from 5000-item bank in < 3 seconds
- [ ] API endpoint: POST /api/exams/blueprints/:id/recommend
- [ ] Results paginated with coverage improvement per additional item
- [ ] Unit tests for algorithm correctness with known inputs/outputs

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/exam/recommendation.types.ts` |
| Algorithm | apps/server | `src/modules/exam/algorithms/coverage-optimizer.ts` |
| Service | apps/server | `src/modules/exam/services/item-recommendation.service.ts` |
| Controller | apps/server | `src/modules/exam/controllers/item-recommendation.controller.ts` |
| Route | apps/server | `src/modules/exam/routes/item-recommendation.routes.ts` |
| API Tests | apps/server | `src/modules/exam/__tests__/coverage-optimizer.test.ts` |
| API Tests | apps/server | `src/modules/exam/__tests__/item-recommendation.service.test.ts` |
| API Tests | apps/server | `src/modules/exam/__tests__/item-recommendation.controller.test.ts` |

## Dependencies
- **Blocks:** S-F-26-3
- **Blocked by:** S-F-26-1 (blueprint model exists)
- **Cross-epic:** Reads from item bank (E-25)

## Notes
- Coverage optimizer uses a weighted greedy algorithm; exact optimization is NP-hard, so greedy is acceptable.
- Multi-dimensional scoring: weighted sum of per-dimension coverage percentages.
- Item metadata needed: USMLE system, discipline, Bloom level, difficulty, concept tags.
- Neo4j graph queries may be used to find items by concept relationships.
- Consider caching item metadata for performance.
