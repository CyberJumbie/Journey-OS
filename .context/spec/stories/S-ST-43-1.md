# S-ST-43-1: Trend Charts

**Epic:** E-43 (Student Progress Analytics)
**Feature:** F-20
**Sprint:** 28
**Lane:** student (P4)
**Size:** M

## User Story
As a **medical student**, I need to see trend charts showing my mastery improvement over time so that I can understand my learning trajectory and stay motivated.

## Acceptance Criteria
- [ ] Line chart showing overall mastery percentage over time (daily/weekly granularity toggle)
- [ ] Multi-series chart: one line per USMLE system (toggleable)
- [ ] Date range selector: last 7 days, 30 days, 90 days, all time
- [ ] Hover tooltip showing exact values at data points
- [ ] Legend with system names and current mastery values
- [ ] Milestone markers on chart (e.g., "Started Cardiology review")
- [ ] Chart renders with D3.js or Recharts (consistent with project choice)
- [ ] Responsive: chart resizes on viewport change
- [ ] Loading skeleton matching chart dimensions
- [ ] Empty state when insufficient data points (< 2 sessions)

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/student/analytics.types.ts` |
| Service | apps/server | `src/modules/student/services/mastery-trend.service.ts` |
| Controller | apps/server | `src/modules/student/controllers/student-analytics.controller.ts` |
| Route | apps/server | `src/modules/student/routes/student-analytics.routes.ts` |
| View | apps/web | `src/app/(dashboard)/student/analytics/page.tsx` |
| Component | apps/web | `src/components/student/mastery-trend-chart.tsx` |
| Component | apps/web | `src/components/student/chart-date-range-selector.tsx` |
| API Tests | apps/server | `src/modules/student/__tests__/mastery-trend.service.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-ST-42-1 (student dashboard exists)
- **Cross-epic:** none

## Notes
- Data aggregation happens server-side; API returns time-series arrays.
- Use Recharts for consistency (already a project dependency for heatmap).
- Consider memoization for expensive chart re-renders.
- Chart color palette must use design tokens, not hardcoded hex values.
