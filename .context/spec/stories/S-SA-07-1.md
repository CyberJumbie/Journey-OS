# S-SA-07-1: Global User Directory

**Epic:** E-07 (Cross-Institution User Management)
**Feature:** F-03
**Sprint:** 3
**Lane:** superadmin (P1)
**Size:** M

## User Story
As a **SuperAdmin**, I need a global user directory that spans all institutions so that I can search, filter, and manage any user on the platform regardless of their institution.

## Acceptance Criteria
- [ ] Global user directory page at /admin/users (SuperAdmin only)
- [ ] Table columns: name, email, role, institution, status, last login
- [ ] Sortable by: name, role, institution, status, last login
- [ ] Filterable by: role, institution, status
- [ ] Cross-institution search by name or email
- [ ] Pagination: 25 items per page with cursor-based navigation
- [ ] Click-through to user detail page with full profile and activity
- [ ] RBAC: SuperAdmin only (403 for all other roles)
- [ ] Performance: efficient query across potentially thousands of users
- [ ] 10 API tests: list endpoint, cross-institution query, pagination, filtering, sorting, search, auth enforcement, role restriction, empty results, institution filter

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | src/user/global-user.types.ts |
| Repository | apps/server | src/repositories/global-user.repository.ts |
| Service | apps/server | src/services/user/global-user.service.ts |
| Controller | apps/server | src/controllers/user/global-user.controller.ts |
| Routes | apps/server | src/routes/admin/user-management.routes.ts |
| View | apps/web | src/app/(protected)/admin/users/page.tsx |
| Components | packages/ui | src/components/tables/global-user-table.tsx, src/components/filters/institution-filter.tsx |
| Tests | apps/server | src/controllers/user/__tests__/global-user.controller.test.ts |

## Dependencies
- **Blocks:** S-SA-07-2
- **Blocked by:** S-U-01-3
- **Cross-epic:** S-IA-06-1 (reuses user table patterns)

## Notes
- Unlike S-IA-06-1 which scopes to one institution, this directory has no institution filter by default.
- Reuse the user table organism from packages/ui; extend with institution column.
- Consider database indexing on (email, institution_id, role) for performant cross-institution queries.
- SuperAdmin override: no institution_id scoping in the repository query.
