# S-IA-29-1: Gap Drill-Down UI

**Epic:** E-29 (Gap-Driven Generation)
**Feature:** F-13
**Sprint:** 8
**Lane:** institutional_admin (P2)
**Size:** M

## User Story
As an **Institutional Admin**, I need to click a heatmap cell and drill down into the specific USMLE topics with blind spots so that I can understand exactly which concepts are under-assessed and take targeted action.

## Acceptance Criteria
- [ ] Clicking a heatmap cell opens a drill-down panel/page for that system-discipline intersection
- [ ] Drill-down shows: list of USMLE Topics in that cell, each with coverage percentage
- [ ] Topics sorted by coverage ascending (worst gaps first)
- [ ] Each topic expandable to show SubConcepts with individual coverage status (assessed/unassessed)
- [ ] "Blind spots" badge on topics with >50% unassessed SubConcepts
- [ ] Summary stats at top: total topics, topics with gaps, total blind spots
- [ ] Action button per topic: "Generate Questions" (navigates to workbench with gap scope)
- [ ] Breadcrumb navigation: Heatmap → System: Discipline → Topic details
- [ ] 8-10 API tests: drill-down rendering, topic list sorting, SubConcept expansion, blind spot detection, navigation
- [ ] Named exports only, TypeScript strict, design tokens only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/coverage/gap-drilldown.types.ts` |
| Atoms | packages/ui | `src/atoms/coverage-badge.tsx`, `src/atoms/blind-spot-indicator.tsx` |
| Molecules | packages/ui | `src/molecules/topic-coverage-row.tsx` |
| Organisms | apps/web | `src/components/coverage/gap-drilldown-panel.tsx`, `src/components/coverage/topic-subconcept-list.tsx` |
| Pages | apps/web | `src/app/(institutional-admin)/coverage/[system]/[discipline]/page.tsx` |
| Hooks | apps/web | `src/hooks/use-gap-drilldown.ts` |
| Tests | apps/web | `src/tests/coverage/gap-drilldown-panel.test.tsx` |

## Dependencies
- **Blocks:** S-IA-29-2
- **Blocked by:** S-IA-28-2 (heatmap component to click from)
- **Cross-epic:** none

## Notes
- Route: `/coverage/[system]/[discipline]` — uses dynamic segments for the USMLE system and discipline
- Data fetched from `/api/coverage/drilldown?system=cardiovascular&discipline=pathology`
- Neo4j query: `MATCH (t:USMLE_Topic)-[:IN_SYSTEM]->(s:USMLE_System {name: $system}), (t)-[:IN_DISCIPLINE]->(d:USMLE_Discipline {name: $discipline}) OPTIONAL MATCH (sc:SubConcept)-[:BELONGS_TO]->(t) OPTIONAL MATCH (q:Question)-[:ASSESSES]->(sc) RETURN t, collect(sc), count(q)`
- Blind spot logic: topic.blind_spot = (unassessed_subconcepts / total_subconcepts) > 0.5
- "Generate Questions" button passes scope params via URL: `/workbench?mode=generate&system=X&discipline=Y&topic=Z`
