# S-F-24-2: Field Mapping UI

**Epic:** E-24 (Legacy Import Pipeline)
**Feature:** F-11
**Sprint:** 17
**Lane:** faculty (P3)
**Size:** M

## User Story
As a **Faculty member**, I need a field mapping interface to assign columns from my legacy file to Journey OS fields so that the import correctly interprets my data format.

## Acceptance Criteria
- [ ] Upload step: drag-and-drop file upload with format auto-detection
- [ ] Preview step: show first 5 rows of parsed data in a table
- [ ] Mapping step: dropdown selectors to map source columns to target fields
- [ ] Target fields: stem, vignette, answer_choices (A-E), correct_answer, rationale, difficulty, tags, course
- [ ] Auto-mapping: suggest mappings based on column header similarity
- [ ] Validation: required fields marked, error shown if unmapped
- [ ] Mapping presets: save column mapping for reuse with similar files
- [ ] Confirmation step: summary of mapping with row count before import
- [ ] 8-12 API tests: file upload, preview generation, mapping validation, preset save/load
- [ ] TypeScript strict, named exports only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/import/mapping.types.ts` |
| Controller | apps/server | `src/controllers/import/import-upload.controller.ts` |
| View | apps/web | `src/app/(dashboard)/faculty/import/page.tsx`, `src/components/import/FileUploadZone.tsx`, `src/components/import/DataPreview.tsx`, `src/components/import/FieldMapper.tsx`, `src/components/import/ImportSummary.tsx` |
| Tests | apps/server | `src/tests/import/import-upload.controller.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-F-24-1 (parsers exist to generate preview data)
- **Cross-epic:** none

## Notes
- Multi-step wizard pattern: Upload → Preview → Map → Confirm → Import
- Auto-mapping heuristic: Levenshtein distance between column headers and target field names
- Mapping presets stored per user in Supabase `import_presets` table
- File upload to Supabase Storage temp bucket; cleaned up after import completes or 24h TTL
- shadcn/ui Stepper component for wizard navigation
- Support drag-and-drop reordering in mapper for answer choices (A-E ordering)
