# S-F-25-1: Item Bank Browser Page

**Epic:** E-25 (Item Bank Browser & Export)
**Feature:** F-11
**Sprint:** 18
**Lane:** faculty (P3)
**Size:** L

## User Story
As a **Faculty member**, I need a searchable item bank browser with advanced filtering so that I can find, review, and manage approved questions across my courses.

## Acceptance Criteria
- [ ] Paginated table/card view toggle for browsing approved questions
- [ ] Advanced search: full-text search on stem, vignette, rationale
- [ ] Semantic search: pgvector similarity search for "find questions like this"
- [ ] Filters: course, question type, Bloom level, difficulty, USMLE system, discipline, tags, date range, status
- [ ] Sort by: date created, difficulty, Bloom level, composite score, course
- [ ] Bulk selection for batch operations (export, tag, archive)
- [ ] Quick preview: hover/click to see full question without navigating away
- [ ] Bookmark/favorite functionality for frequently accessed items
- [ ] Result count and active filter chips with clear-all
- [ ] Custom error class: `ItemBankQueryError`
- [ ] 12-18 API tests: text search, semantic search, all filters, sorting, pagination, bulk select, bookmark
- [ ] 1-2 E2E tests: search flow, filter + export flow
- [ ] TypeScript strict, named exports only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/item-bank/browser.types.ts`, `src/item-bank/search.types.ts` |
| Repository | apps/server | `src/repositories/item-bank.repository.ts` |
| Service | apps/server | `src/services/item-bank/item-bank-browser.service.ts`, `src/services/item-bank/item-search.service.ts` |
| Controller | apps/server | `src/controllers/item-bank/item-bank.controller.ts` |
| View | apps/web | `src/app/(dashboard)/faculty/item-bank/page.tsx`, `src/components/item-bank/ItemBankTable.tsx`, `src/components/item-bank/ItemBankFilters.tsx`, `src/components/item-bank/ItemPreviewCard.tsx`, `src/components/item-bank/SemanticSearchInput.tsx` |
| Errors | apps/server | `src/errors/item-bank.errors.ts` |
| Tests | apps/server | `src/tests/item-bank/item-bank-browser.test.ts`, `src/tests/item-bank/item-search.test.ts` |

## Dependencies
- **Blocks:** S-F-25-2, S-F-25-3, S-F-25-4
- **Blocked by:** S-F-21-4 (tags exist), S-F-23-3 (approved items exist)
- **Cross-epic:** S-F-21-4 (Sprint 12 tagging), S-F-23-3 (Sprint 13 review actions)

## Notes
- Full-text search uses Supabase `tsvector` index on stem + vignette + rationale columns
- Semantic search uses pgvector cosine similarity on stored embeddings (1024-dim Voyage AI)
- Table/card toggle: table for dense scanning, cards for visual browsing with stem preview
- Quick preview: shadcn/ui Sheet (side panel) with full question display
- Bookmark stored in Supabase `user_bookmarks` table (user_id + question_id)
- Filter state persisted in URL query params for shareable filtered views
- Consider virtual scrolling for large result sets (react-virtual)
