# S-IA-15-3: Visual Mapping Interface

**Epic:** E-15 (Objective Mapping & Framework Linking)
**Feature:** F-07
**Sprint:** 5
**Lane:** institutional_admin (P2)
**Size:** L

## User Story
As an **Institutional Admin**, I need a drag-and-drop visual interface for mapping SLOs to ILOs and linking objectives to framework nodes so that curriculum alignment is intuitive and efficient.

## Acceptance Criteria
- [ ] Split-panel layout: SLOs on left, ILOs on right, framework nodes in collapsible panel
- [ ] Drag SLO onto ILO to create FULFILLS proposal
- [ ] Drag objective onto framework node to create framework link
- [ ] Visual connection lines showing existing relationships
- [ ] Color-coded relationship types (FULFILLS, AT_BLOOM, MAPS_TO_COMPETENCY, etc.)
- [ ] Undo: remove a proposed link before submitting
- [ ] Bulk submit: send all proposed links as a batch
- [ ] Controller endpoints: batch link creation, link deletion
- [ ] Responsive: minimum 1024px viewport width
- [ ] 12-15 API tests for batch link creation, drag-drop data format, validation
- [ ] 1 E2E test: drag SLO onto ILO, submit, verify FULFILLS proposal created

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Controller | apps/server | `src/controllers/mapping.controller.ts` |
| Route | apps/server | `src/routes/mapping.routes.ts` |
| View - Mapper | apps/web | `src/components/organisms/ObjectiveMapper/ObjectiveMapper.tsx` |
| View - SLO Panel | apps/web | `src/components/molecules/SLOPanel.tsx` |
| View - ILO Panel | apps/web | `src/components/molecules/ILOPanel.tsx` |
| View - Framework Panel | apps/web | `src/components/molecules/FrameworkPanel.tsx` |
| View - Connection | apps/web | `src/components/atoms/ConnectionLine.tsx` |
| View - Draggable | apps/web | `src/components/atoms/DraggableNode.tsx` |
| Tests | apps/server | `src/tests/mapping.controller.test.ts` |
| E2E | apps/web | `e2e/objective-mapping.spec.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-IA-15-1 (FULFILLS workflow), S-IA-15-2 (framework linking service)
- **Cross-epic:** S-U-01-3 (RBAC: institutional_admin role)

## Notes
- ObjectiveMapper is an Organism with SLOPanel, ILOPanel, FrameworkPanel (Molecules) and ConnectionLine, DraggableNode (Atoms)
- Use a library like @dnd-kit/core for drag-and-drop (React DnD alternative)
- Connection lines rendered with SVG paths between related nodes
- Color coding per relationship type using design tokens
- Bulk submit calls FULFILLS workflow (S-IA-15-1) and framework linking (S-IA-15-2) services
- Performance: lazy-load framework panel; only fetch framework nodes when panel is expanded
