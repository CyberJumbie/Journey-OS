# S-F-27-1: Cohort Assignment

**Epic:** E-27 (Exam Assignment & Export)
**Feature:** F-12
**Sprint:** 30
**Lane:** faculty (P3)
**Size:** M

## User Story
As a **faculty member**, I need to assign a completed exam to a student cohort with a schedule so that students can take the exam at the designated time.

## Acceptance Criteria
- [ ] Cohort selection dropdown (existing cohorts from institution)
- [ ] Schedule configuration: start date/time, end date/time, time window
- [ ] Exam must be in 'draft' or 'ready' status to assign
- [ ] Assignment transitions exam status from 'draft' to 'assigned'
- [ ] Confirmation dialog before assignment (irreversible for draft exams)
- [ ] Notification trigger to assigned cohort (stub for notification service)
- [ ] Assignment record stored with audit trail (who assigned, when)
- [ ] API endpoint: POST /api/exams/:id/assign
- [ ] View: assignment form as modal in exam builder
- [ ] Validation: end time must be after start time, minimum 30 min window

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/exam/assignment.types.ts` |
| Model | apps/server | `src/modules/exam/models/exam-assignment.model.ts` |
| Repository | apps/server | `src/modules/exam/repositories/exam-assignment.repository.ts` |
| Service | apps/server | `src/modules/exam/services/exam-assignment.service.ts` |
| Controller | apps/server | `src/modules/exam/controllers/exam-assignment.controller.ts` |
| Route | apps/server | `src/modules/exam/routes/exam-assignment.routes.ts` |
| View | apps/web | `src/components/exam/cohort-assignment-modal.tsx` |
| API Tests | apps/server | `src/modules/exam/__tests__/exam-assignment.service.test.ts` |
| API Tests | apps/server | `src/modules/exam/__tests__/exam-assignment.controller.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-F-26-3 (exam must be built)
- **Cross-epic:** Notification stub connects to E-34 (notification system)

## Notes
- DualWriteService: Supabase `exam_assignments` table, then Neo4j (Exam)-[:ASSIGNED_TO]->(Cohort).
- Cohort data comes from institution management (E-06).
- Notification is a stub/event emission; actual delivery handled by E-34 in later sprint.
