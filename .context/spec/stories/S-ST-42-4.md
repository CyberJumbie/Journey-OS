# S-ST-42-4: Session History

**Epic:** E-42 (Student Dashboard)
**Feature:** F-20
**Sprint:** 27
**Lane:** student (P4)
**Size:** M

## User Story
As a **medical student**, I need to view my practice session history with date, duration, and score so that I can track my study habits and identify patterns.

## Acceptance Criteria
- [ ] Session history table with columns: date, duration, questions answered, score, concepts covered
- [ ] Sortable by date (default: newest first), duration, or score
- [ ] Pagination: 10 sessions per page
- [ ] Filter by date range (last 7 days, 30 days, all time)
- [ ] Filter by USMLE system
- [ ] Click session row to expand and show concept-level breakdown
- [ ] Empty state for students with no sessions
- [ ] Session data stored in Supabase with dual-write to Neo4j
- [ ] API endpoint returns paginated session history
- [ ] Loading skeleton for table

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/student/session.types.ts` |
| Model | apps/server | `src/modules/student/models/practice-session.model.ts` |
| Repository | apps/server | `src/modules/student/repositories/practice-session.repository.ts` |
| Service | apps/server | `src/modules/student/services/session-history.service.ts` |
| Controller | apps/server | `src/modules/student/controllers/session-history.controller.ts` |
| Route | apps/server | `src/modules/student/routes/session-history.routes.ts` |
| View | apps/web | `src/components/student/session-history-table.tsx` |
| Component | apps/web | `src/components/student/session-detail-row.tsx` |
| API Tests | apps/server | `src/modules/student/__tests__/session-history.service.test.ts` |
| API Tests | apps/server | `src/modules/student/__tests__/session-history.controller.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-ST-42-1 (dashboard page exists)
- **Cross-epic:** Session records created by adaptive practice (S-ST-41-1) in Sprint 32; mock data until then

## Notes
- DualWriteService: Supabase first (practice_sessions table) then Neo4j (Student)-[:COMPLETED]->(PracticeSession).
- Table component should use packages/ui DataTable atom.
- Consider virtual scrolling if session count becomes large.
