# S-IA-33-3: Cross-Course Comparison

**Epic:** E-33 (Course & Teaching Analytics)
**Feature:** F-15
**Sprint:** 18
**Lane:** institutional_admin (P2)
**Size:** M

## User Story
As an **Institutional Admin**, I need a cross-course comparison view so that I can identify which courses have strong item banks and which need attention.

## Acceptance Criteria
- [ ] Multi-course comparison table: courses as rows, metrics as columns
- [ ] Metrics: total items, approved count, average quality, SLO coverage %, Bloom diversity
- [ ] Radar chart: overlay up to 5 courses on multi-axis chart for visual comparison
- [ ] Ranking: sortable by any metric column
- [ ] Highlight: courses below institutional thresholds flagged with warning indicators
- [ ] Drill-down: click course row to navigate to course analytics detail
- [ ] Export comparison as CSV or PDF
- [ ] 8-12 API tests: multi-course query, ranking, threshold flagging, export
- [ ] TypeScript strict, named exports only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/analytics/comparison.types.ts` |
| Service | apps/server | `src/services/analytics/course-comparison.service.ts` |
| Controller | apps/server | `src/controllers/analytics/course-comparison.controller.ts` |
| View | apps/web | `src/app/(dashboard)/admin/analytics/comparison/page.tsx`, `src/components/analytics/ComparisonTable.tsx`, `src/components/analytics/CourseRadarChart.tsx` |
| Tests | apps/server | `src/tests/analytics/course-comparison.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-IA-33-1 (course analytics queries exist to aggregate across)
- **Cross-epic:** none

## Notes
- Radar chart axes: Quality, Coverage, Volume, Bloom Diversity, Difficulty Balance
- Bloom diversity: entropy measure of Bloom level distribution (higher = more diverse)
- Institutional thresholds configurable in admin settings (e.g., min coverage 70%, min quality 3.5)
- Comparison limited to courses within admin's institution scope
- PDF export using server-side rendering (e.g., Puppeteer or react-pdf)
- Consider quarterly comparison snapshots for trend analysis over terms
