# S-SA-05-3: Institution Suspend/Reactivate

**Epic:** E-05 (Institution Monitoring)
**Feature:** F-02
**Sprint:** 9
**Lane:** superadmin (P1)
**Size:** S

## User Story
As a **SuperAdmin**, I need to suspend and reactivate institutions so that I can manage platform access for institutions that violate policies or request temporary deactivation.

## Acceptance Criteria
- [ ] Suspend action: sets institution status to `suspended`, disables all user logins for that institution
- [ ] Reactivate action: sets institution status to `active`, re-enables user logins
- [ ] Confirmation dialog before suspend: "This will prevent all N users from logging in. Proceed?"
- [ ] Reason field required when suspending (stored in `institution_status_changes` audit table)
- [ ] Status change reflected in institution list and detail views immediately
- [ ] Suspended institution users see "Your institution has been suspended" on login attempt
- [ ] Email notification to institution admin on suspend/reactivate (if email service available)
- [ ] Audit trail: all status changes logged with actor, timestamp, reason
- [ ] 5-8 API tests: suspend flow, reactivate flow, auth blocking for suspended users, audit logging, reason validation
- [ ] Named exports only, TypeScript strict

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/admin/institution-lifecycle.types.ts` |
| Service | apps/server | `src/services/admin/institution-lifecycle.service.ts` |
| Controller | apps/server | `src/controllers/admin/institution.controller.ts` (update) |
| Middleware | apps/server | `src/middleware/institution-status.middleware.ts` |
| Organisms | apps/web | `src/components/admin/suspend-dialog.tsx` |
| Tests | apps/server | `src/tests/admin/institution-lifecycle.test.ts` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-SA-05-1 (institution list), S-SA-04-3 (institution model)
- **Cross-epic:** S-SA-04-3 (Sprint 4 institution lifecycle)

## Notes
- Auth middleware check: on every authenticated request, verify `institution.status !== 'suspended'`; if suspended, return 403 with message
- `institution-status.middleware.ts` runs after JWT validation, before route handler
- Audit table `institution_status_changes`: `{ id, institution_id, from_status, to_status, reason, actor_id, created_at }`
- DualWriteService: update institution status in Supabase first, then Neo4j `(Institution {status: 'suspended'})`
- Suspend does NOT delete data â€” all data preserved for reactivation
- API endpoints: `POST /api/admin/institutions/:id/suspend` and `POST /api/admin/institutions/:id/reactivate`
