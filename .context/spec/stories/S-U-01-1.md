# S-U-01-1: Supabase Auth Setup

**Epic:** E-01 (Auth Infrastructure)
**Feature:** F-01
**Sprint:** 3
**Lane:** universal (P0)
**Size:** S

## User Story
As a **platform engineer**, I need Supabase Auth configured with email/password provider, JWT secret, and email templates so that all user authentication flows have a secure foundation.

## Acceptance Criteria
- [ ] Supabase project configured with email/password auth provider
- [ ] JWT secret stored in environment variables (never hardcoded)
- [ ] Custom email templates for: verification, invitation, password reset
- [ ] Auth-related TypeScript types defined (AuthUser, AuthSession, AuthRole enum)
- [ ] AuthRole enum includes: superadmin, institutional_admin, faculty, student, advisor
- [ ] Supabase client singleton configured in apps/server
- [ ] Supabase client configured in apps/web with public anon key
- [ ] Session persistence across page refresh via Supabase auth helpers
- [ ] Environment variable validation on server startup (fail-fast if missing)

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | src/auth/auth.types.ts, src/auth/roles.types.ts, src/auth/index.ts |
| Config | apps/server | src/config/supabase.config.ts, src/config/env.config.ts |
| Config | apps/web | src/lib/supabase.ts |

## Dependencies
- **Blocks:** S-U-01-2, S-U-01-3, S-U-01-4
- **Blocked by:** none
- **Cross-epic:** none

## Notes
- Supabase custom claims will store the user role in JWT metadata for middleware extraction.
- Use `app_metadata.role` (not `user_metadata`) so users cannot self-modify their role.
- Email templates should be branded with Journey OS logo and styling.
- All Supabase operations through Supabase MCP per architecture rules.
