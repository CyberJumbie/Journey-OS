# S-F-19-4: Generation Spec Wizard

**Epic:** E-19 (Workbench UI)
**Feature:** F-09
**Sprint:** 7
**Lane:** faculty (P3)
**Size:** M

## User Story
As a **Faculty member**, I need a generation specification wizard so that I can configure question parameters (type, difficulty, scope, constraints) before launching generation, ensuring the pipeline produces items that match my exact requirements.

## Acceptance Criteria
- [ ] Multi-step wizard form: Step 1 (Question Type), Step 2 (Difficulty & Bloom's), Step 3 (Scope), Step 4 (Constraints & Review)
- [ ] Question Type selector: Single Best Answer, Extended Matching, Sequential Set (USMLE Step formats)
- [ ] Difficulty selector: Easy / Medium / Hard with description tooltips
- [ ] Bloom's Level selector: Remember, Understand, Apply, Analyze, Evaluate, Create
- [ ] Scope selector: Course dropdown, SLO multi-select, Concept tag multi-select
- [ ] Constraints: max vignette length, required keywords, excluded topics
- [ ] Review step: summary of all selections before launching generation
- [ ] Form validation with inline errors (react-hook-form + zod)
- [ ] Wizard state preserved if user switches mode and comes back
- [ ] "Quick Generate" shortcut: pre-fills defaults and skips to review step
- [ ] 8-12 API tests: form validation, step navigation, state persistence, quick generate, submission
- [ ] Named exports only, TypeScript strict, design tokens only

## Implementation Layers
| Layer | Package | Files |
|-------|---------|-------|
| Types | packages/types | `src/generation/spec.types.ts` |
| Atoms | packages/ui | `src/atoms/step-indicator.tsx` |
| Molecules | packages/ui | `src/molecules/wizard-step.tsx`, `src/molecules/multi-select-tags.tsx` |
| Organisms | apps/web | `src/components/workbench/generation-wizard.tsx`, `src/components/workbench/wizard-steps/question-type-step.tsx`, `src/components/workbench/wizard-steps/difficulty-step.tsx`, `src/components/workbench/wizard-steps/scope-step.tsx`, `src/components/workbench/wizard-steps/review-step.tsx` |
| Hooks | apps/web | `src/hooks/use-wizard-state.ts` |
| Tests | apps/web | `src/tests/workbench/generation-wizard.test.tsx` |

## Dependencies
- **Blocks:** none
- **Blocked by:** S-F-19-1 (SplitPane layout)
- **Cross-epic:** S-IA-14-2 (SLOs for scope selection), S-F-12-1 (concepts for scope selection)

## Notes
- Wizard uses `react-hook-form` with Zod schema validation per step
- Step navigation: linear with back/next, but steps are individually validated
- Quick Generate: uses last-used configuration or sensible defaults (SBA, Medium, Apply, current course)
- Wizard output is a `GenerationSpec` object that gets sent to the SSE generation endpoint
- Scope selectors fetch data from API: courses from CourseService, SLOs from SLOService, concepts from ConceptService
- The wizard is rendered inside the chat panel area when in Generate mode, replacing the chat temporarily until config is complete
